# Copyright (C) 2013-2018 Nicolas Lamirault <nicolas.lamirault@gmail.com>

# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#     http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.

- name: Verify Golang archive
  stat:
    path: /home/{{ ansible_user }}/Apps/go{{ go_version }}.linux-amd64.tar.gz
  register: golang_archive

- name: Download Golang
  get_url:
    url: https://storage.googleapis.com/golang/go{{ go_version }}.linux-amd64.tar.gz
    dest: /home/{{ ansible_user }}/Apps/go{{ go_version }}.linux-amd64.tar.gz
    mode: 0440
  when: golang_archive.stat.exists == False

- name: Verify Rustup
  stat:
    path: /home/{{ ansible_user }}/Apps/rustup.sh
  register: rust_archive

- name: Download Rustup
  get_url:
    url: https://sh.rustup.rs
    dest: /home/{{ ansible_user }}/Apps/rustup.sh
    mode: 0440
  when: rust_archive.stat.exists == False

- name: Verify Swift archive
  stat:
    path: /home/{{ ansible_user }}/Apps/swift-{{ swift_version }}-RELEASE-ubuntu16.10.tar.gz
  register: swift_archive

- name: Download Swift
  get_url:
    url: https://swift.org/builds/swift-{{ swift_version }}-release/ubuntu1610/swift-{{ swift_version }}-RELEASE/swift-{{ swift_version }}-RELEASE-ubuntu16.10.tar.gz
    dest: /home/{{ ansible_user }}/Apps/swift-{{ swift_version }}-RELEASE-ubuntu16.10.tar.gz
    mode: 0440
  when: swift_archive.stat.exists == False

- name: Verify NodeJS archive
  stat:
    path: /home/{{ ansible_user }}/Apps/node-v{{ node_version }}-linux-x64.tar.xz
  register: node_archive

- name: Download NodeJS
  get_url:
    url: https://nodejs.org/dist/v{{ node_version }}/node-v{{ node_version }}-linux-x64.tar.xz
    dest: /home/{{ ansible_user }}/Apps/node-v{{ node_version }}-linux-x64.tar.xz
    mode: 0440
  when: node_archive.stat.exists == False

- name: Verify Erlang archive
  stat:
    path: /home/{{ ansible_user }}/Apps/otp_src_{{ erlang_version }}.tar.gz
  register: erlang_archive

- name: Download Erlang
  get_url:
    url: http://erlang.org/download/otp_src_{{ erlang_version }}.tar.gz
    dest: /home/{{ ansible_user }}/Apps/otp_src_{{ erlang_version }}.tar.gz
    mode: 0440
  when: erlang_archive.stat.exists == False
