- name: Install Cask
  command: python /tmp/cask.py creates=/home/$user/.cask

- name: Emacs configuration files
  copy: src=files/emacs dest=/home/$user/.emacs

- name: Creates Emacs directory
  action: file path=/home/$user/.emacs.d state=directory

- name: Emacs configuration files
  copy: src=$item dest=/home/$user/.emacs.d/
  with_fileglob:
    - files/*.el
    - files/Cask

- name: Creates Emacs themes directory
  action: file path=/home/$user/.emacs.d/themes state=directory

- name: Emacs theme
  copy: src=$item dest=/home/$user/.emacs.d/themes/
  with_fileglob:
    - files/themes/*.el

- name: Check Cask installation
  command: ls /home/$user/.cask/ && ls /home/$user/.emacs.d/ 

- name: Emacs configuration using Cask
  command: /home/$user/.cask/bin/cask chdir=/home/$user/.emacs.d/
